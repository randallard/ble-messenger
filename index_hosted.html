<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arduino Control Center</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/uuid.min.js"></script>
    <script type="module" src="js/main.js"></script>
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components/buttons.css">
    <link rel="stylesheet" href="css/components/inputs.css">
    <link rel="stylesheet" href="css/components/status.css">
    <link rel="stylesheet" href="css/components/notifications.css">
    <link rel="stylesheet" href="css/components/connections.css">
    <link rel="stylesheet" href="css/components/theme-toggle.css">
    <link rel="stylesheet" href="css/components/message-area.css">
</head>
<body>

    <div id="initialSetup" class="section">
        <h1>Welcome to BAM</h1>
        <p>Bluetooth and Messaging</p>
        
        <div class="input-container">
            <input type="text" id="initialUserName" placeholder="Enter your name">
            <button id="saveInitialName" class="button">Save Name</button>
            <p>or</p>
            <input type="file" id="restoreBackup" accept=".json"  style="display: none;">
            <button id="loadBackupBtn1" class="button">Load from Backup</button>
        </div>
    </div>
    
    <!-- Add hidden class to other sections -->
    <div id="mainContent" class="hidden">
        <button id="themeToggle" class="theme-toggle" title="Toggle dark mode">
            üåì
        </button>
        <h1>Welcome to BAM</h1>
        <p>Bluetooth and Messaging</p>

        <div class="section">

            <div id="setupArea">
                <h2>Friend Connection</h2>
                <div id="newConnection">
                    <input type="text" id="newFriendlyName" placeholder="Enter a friendly name for new connection">
                    <button id="createConnectionBtn" class="button" onclick="createConnection()" disabled>Create Connection</button>
                </div>

                <div id="joinConnection">
                    <input type="text" id="linkInput" placeholder="Enter connection link">
                    <input type="text" id="friendlyName" placeholder="Enter a friendly name">
                    <button class="button" onclick="joinConnection()">Join</button>
                </div>

                <div id="savedConnections" class="saved-connections">
                    <h3>Saved Connections</h3>
                    <!-- Saved connections will be populated here -->
                </div>
            </div>

            <div id="chatArea" class="hidden">
                <h2>Chat</h2>
                <div id="messageArea"></div>
                <div class="input-container">
                    <input type="text" id="messageInput" placeholder="Type your message">
                    <button class="button" onclick="sendMessage()">Send</button>
                    <button class="button" onclick="sendHeartAnimation()">‚ù§Ô∏è</button>
                </div>
            </div>
        </div>

        <div id="notifications"></div>    
        
        <div class="section">
            <h2>Device Control</h2>
            <div id="status" class="disconnected">Disconnected</div>
            <button id="connectBtn" class="button">Connect to Device</button>
            <button id="startAnimation" class="button" disabled>Start Animation</button>
            <button id="stopAnimation" class="button" disabled>Stop Animation</button>
            
            <div class="input-container">
                <input type="text" id="customText" maxlength="32" placeholder="Enter custom text (max 32 characters)">
                <button id="sendText" class="button" disabled>Send Text</button>
            </div>
        </div>

        <div class="section">
            <h2>User Profile & Data Management</h2>
            <!-- User Identity Section -->
            <div id="userIdentitySection" class="input-container">
                <div id="nameDisplay" style="display: none;">
                    <p>Your Name: <span id="displayedName"></span> 
                    <button id="editNameBtn" class="button" style="padding: 5px 10px; margin-left: 10px;">Edit</button>
                    </p>
                    <p style="color: #666; font-size: 0.9em;">Player ID: <span id="playerIdDisplay"></span></p>
                </div>
                <div id="nameInput" style="display: none;">
                    <input type="text" id="userNameField" placeholder="Enter your name">
                    <button id="saveNameBtn" class="button" style="padding: 5px 10px;">Save</button>
                </div>
            </div>
            <button id="exportDataBtn" class="button">Export Local Storage Data</button>
            <div class="file-input-container">
                <input type="file" id="backupFileInput" accept=".json" style="display: none;">
                <button id="loadBackupBtn" class="button">Load Backup</button>
            </div>
            <div id="dataManagementStatus" style="margin-top: 10px;"></div>
        </div> 
    </div>
</body>
</html>